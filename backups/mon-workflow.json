{
  "": "",
  "active": false,
  "connections": {
    "Set date": {
      "main": [
        [
          {
            "node": "Format date",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format date": {
      "main": [
        [
          {
            "node": "Set commit date",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set commit date": {
      "main": [
        [
          {
            "node": "List files from repository [GITHUB]",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "List files from repository [GITHUB]": {
      "main": [
        [
          {
            "node": "Combine file names [GITHUB]",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Combine file names [GITHUB]": {
      "main": [
        [
          {
            "node": "Retrieve workflows [N8N]",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Retrieve workflows [N8N]": {
      "main": [
        [
          {
            "node": "Move JSON to binary",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Move JSON to binary": {
      "main": [
        [
          {
            "node": "Split to single items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split to single items": {
      "main": [
        [
          {
            "node": "Check if file exists in repository",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check if file exists in repository": {
      "main": [
        [
          {
            "node": "Update file [GITHUB]",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Upload file [GITHUB]",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update file [GITHUB]": {
      "main": [
        [
          {
            "node": "Split to single items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload file [GITHUB]": {
      "main": [
        [
          {
            "node": "Split to single items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Set date",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-12-29T02:27:36.387Z",
  "id": "YP66kK2MshITIAV0",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Backup workflow V2",
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "id": "4dc244b9-fabb-4372-8e00-b89761e72408",
      "name": "Set date",
      "type": "n8n-nodes-base.dateTime",
      "typeVersion": 2,
      "position": [
        -1568,
        384
      ]
    },
    {
      "parameters": {
        "operation": "formatDate",
        "date": "={{ $json.currentDate }}",
        "format": "custom",
        "customFormat": "dd-MM-yyyy/H:mm",
        "options": {}
      },
      "id": "c8f5c643-62cf-4c10-936a-d5256cff4c38",
      "name": "Format date",
      "type": "n8n-nodes-base.dateTime",
      "typeVersion": 2,
      "position": [
        -1376,
        384
      ]
    },
    {
      "parameters": {
        "keepOnlySet": true,
        "values": {
          "string": [
            {
              "name": "commitDate",
              "value": "={{ $json.formattedDate }}"
            }
          ]
        },
        "options": {}
      },
      "id": "3545cc1d-a51d-40df-9fb0-6203537f20c0",
      "name": "Set commit date",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [
        -1168,
        384
      ]
    },
    {
      "parameters": {
        "authentication": "oAuth2",
        "resource": "file",
        "operation": "list",
        "owner": {
          "__rl": true,
          "value": "https://github.com/Adam-s-tech/n8n-workflows-backup",
          "mode": "url"
        },
        "repository": {
          "__rl": true,
          "value": "n8n-workflows-backup",
          "mode": "name"
        },
        "filePath": "="
      },
      "id": "ac5378bc-ec05-44fd-8f0c-b02c41b1c211",
      "name": "List files from repository [GITHUB]",
      "type": "n8n-nodes-base.github",
      "typeVersion": 1,
      "position": [
        -976,
        384
      ],
      "alwaysOutputData": true,
      "webhookId": "53fd98fb-b9bc-4ba1-ba51-137534b37462",
      "credentials": {
        "githubOAuth2Api": {
          "id": "JkgRo0W2lAFdyIf4",
          "name": "GitHub account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "aggregateItems",
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "name"
            }
          ]
        },
        "options": {}
      },
      "id": "2a1f6de8-7bd1-42d7-957d-dc24aa6a820d",
      "name": "Combine file names [GITHUB]",
      "type": "n8n-nodes-base.itemLists",
      "typeVersion": 2.1,
      "position": [
        -768,
        384
      ]
    },
    {
      "parameters": {
        "returnAll": false,
        "filters": {},
        "requestOptions": {}
      },
      "id": "b2e32972-f015-4460-bbde-3153c13196ee",
      "name": "Retrieve workflows [N8N]",
      "type": "n8n-nodes-base.n8n",
      "typeVersion": 1,
      "position": [
        -576,
        384
      ],
      "credentials": {
        "n8nApi": {
          "id": "KMOQv6yJi4nvCqcx",
          "name": "n8n V2"
        }
      }
    },
    {
      "parameters": {
        "mode": "jsonToBinary",
        "options": {
          "fileName": "={{ $json.name.replace(/\\s+/g, '-').toLowerCase() }}-{{ $json.id }}.json"
        }
      },
      "id": "bd013155-5f97-414a-8dae-fedd95ec3066",
      "name": "Move JSON to binary",
      "type": "n8n-nodes-base.moveBinaryData",
      "typeVersion": 1,
      "position": [
        -368,
        384
      ]
    },
    {
      "parameters": {
        "batchSize": 1,
        "options": {}
      },
      "id": "02a933da-09db-4dce-9cad-63a2638c0de4",
      "name": "Split to single items",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 2,
      "position": [
        -128,
        384
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $node['Combine file names [GITHUB]'].json.name }}",
              "operation": "notContains",
              "value2": "={{ $binary.data.fileName }}"
            }
          ]
        }
      },
      "id": "3f988585-a62a-49bc-a8e1-f5e231fa3a17",
      "name": "Check if file exists in repository",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        112,
        304
      ]
    },
    {
      "parameters": {
        "authentication": "oAuth2",
        "resource": "file",
        "operation": "edit",
        "owner": {
          "__rl": true,
          "value": "Adam-s-tech",
          "mode": "name"
        },
        "repository": {
          "__rl": true,
          "value": "n8n-workflows-backup",
          "mode": "name"
        },
        "filePath": "={{ $binary.data.fileName }}",
        "binaryData": true,
        "commitMessage": "=backup-{{ $node['Set commit date'].json.commitDate }}"
      },
      "id": "c2247a0d-3424-4a48-a283-fdd4a80addf3",
      "name": "Update file [GITHUB]",
      "type": "n8n-nodes-base.github",
      "typeVersion": 1,
      "position": [
        336,
        96
      ],
      "webhookId": "71ce8766-c61a-4864-b031-01d981d955f2",
      "credentials": {
        "githubOAuth2Api": {
          "id": "JkgRo0W2lAFdyIf4",
          "name": "GitHub account 2"
        }
      }
    },
    {
      "parameters": {
        "authentication": "oAuth2",
        "resource": "file",
        "owner": {
          "__rl": true,
          "mode": "name",
          "value": "Adam-s-tech"
        },
        "repository": {
          "__rl": true,
          "mode": "name",
          "value": "n8n-workflows-backup"
        },
        "filePath": "={{ $json.name.replace(/\\s+/g, '-').toLowerCase() }}-{{ $json.id }}.json",
        "commitMessage": "=backup-{{ $node['Set commit date'].json.commitDate }}"
      },
      "id": "1eb1ebb0-e1fb-4b91-8922-e3d88d9b7326",
      "name": "Upload file [GITHUB]",
      "type": "n8n-nodes-base.github",
      "typeVersion": 1,
      "position": [
        320,
        496
      ],
      "webhookId": "9b18164f-4e4f-4e37-b71e-d4a9d70ada07",
      "credentials": {
        "githubOAuth2Api": {
          "id": "JkgRo0W2lAFdyIf4",
          "name": "GitHub account 2"
        }
      }
    },
    {
      "parameters": {
        "content": "## Déclencheur\nVous pouvez le modifier en « Planifier » pour effectuer des sauvegardes sur une base régulière.",
        "height": 339.51767272727324,
        "width": 182.4715262478496
      },
      "id": "cfd53b03-e01c-41c0-a55e-8e24680a4474",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1808,
        224
      ]
    },
    {
      "parameters": {
        "content": "## Définir et formater la date et l'heure\nCes nœuds sont responsables de la définition de la date et de l'heure au format `dd-MM-yyyy/H:mm`. La date et l'heure sont utilisées pour composer les messages de commit dans GitHub, par exemple : `backup-12-07-2023/14:18`.",
        "height": 339.42690909090965,
        "width": 585.4045090909088
      },
      "id": "0a9bb747-8f97-428a-9137-15848bf1386b",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1616,
        224
      ]
    },
    {
      "parameters": {
        "content": "## Faire une liste des fichiers existants\nRenvoie une liste des fichiers existants (sauvegardes) dans le dépôt GitHub. Les données renvoyées par ces nœuds sont utilisées par le nœud « IF » (plus loin dans le flux de travail) pour vérifier si les fichiers de sauvegarde doivent être créés ou mis à jour.",
        "height": 359,
        "width": 410
      },
      "id": "309991f0-7df9-460f-847a-d875d13cf38f",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1008,
        192
      ]
    },
    {
      "parameters": {
        "content": "## Récupérer le workflow\nRécupérer tous les workflow de votre instance n8n. N'oubliez pas que **vos identifiants doivent pointer vers l'instance que vous souhaitez sauvegarder**.",
        "height": 339.42690909090965,
        "width": 384.14708363636373
      },
      "id": "7f5139b8-36e3-4506-924e-db453c608dba",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -592,
        224
      ]
    },
    {
      "parameters": {
        "content": "## Upload backup\nDiviser les fichiers JSON en lots de 1, vérifier s'ils ont été téléchargés dans le référentiel auparavant. Si oui (true), télécharger la nouvelle version du fichier. Sinon (false), créer le fichier dans le référentiel.",
        "height": 731.633426614796,
        "width": 703.8733020263451
      },
      "id": "31bfc0f2-8217-4cd5-a9d8-2d18f5cb28c5",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -192,
        -48
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 5
            },
            {
              "triggerAtHour": 17
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -1776,
        384
      ],
      "id": "697a21b7-c8cf-4203-a398-58c5deba056e",
      "name": "Schedule Trigger"
    }
  ],
  "pinData": {
    "Schedule Trigger": [
      {
        "json": {
          "timestamp": "2025-12-29T21:42:43.112+01:00",
          "Readable date": "December 29th 2025, 9:42:43 pm",
          "Readable time": "9:42:43 pm",
          "Day of week": "Monday",
          "Year": "2025",
          "Month": "December",
          "Day of month": "29",
          "Hour": "21",
          "Minute": "42",
          "Second": "43",
          "Timezone": "Europe/Paris (UTC+01:00)"
        }
      }
    ]
  },
  "repo_name": "n8n-workflows-nov-25",
  "repo_owner": "Adam-s-tech",
  "repo_path": "backups/",
  "settings": {
    "executionOrder": "v1",
    "callerPolicy": "workflowsFromSameOwner",
    "availableInMCP": false
  },
  "shared": [
    {
      "updatedAt": "2025-12-29T02:27:36.388Z",
      "createdAt": "2025-12-29T02:27:36.388Z",
      "role": "workflow:owner",
      "workflowId": "YP66kK2MshITIAV0",
      "projectId": "oXQkWGdjmWkcvoUC"
    }
  ],
  "staticData": {
    "node:Schedule Trigger": {
      "recurrenceRules": []
    }
  },
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2025-12-30T18:15:14.000Z",
  "versionId": "d1f08923-2397-4fba-aaf7-efeda79ea3d3"
}